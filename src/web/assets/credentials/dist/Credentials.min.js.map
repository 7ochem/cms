{"version":3,"sources":["credentials/src/Credentials.js"],"names":["Credentials","constructor","$loginNameInput","$","this","$passwordInput","Craft","validateOnInput","registerStepHandler","prepareData","bind","LoginForm","$newPasswordInput","onToggleInput","onInput","on","validate","loginNameVal","val","length","window","useEmailAsUsername","t","match","passwordLength","minPasswordLength","attribute","maxPasswordLength","max","ev","error","clearErrors","loginName","password"],"mappings":"AAAA,aACA,MAAMA,YAANC,cACIA,KAAWC,gBAAGC,EAAA,cACVC,KAAKF,eAAoBC,EAAA,aACzBC,KAAKC,iBAAmB,EACxBC,MAAKC,UAALC,oBAAAJ,KAAAK,YAAAC,KAAAN,OACAE,IAAMK,MAAAA,cAAUH,KAAAA,eAAyBC,CACrCH,cAAoBM,IACpBC,KAAgBD,eAAAA,IAAD,SACNP,KAAAA,eAAmBO,EACnBP,KAAAA,eAAiBO,GAAAA,QAAtBR,KAAAU,QAAAJ,KAAAN,UAHRA,KAAAF,gBAAAa,GAAA,QAAAX,KAAAU,QAAAJ,KAAAN,OAOAA,KAAKF,eAAmBa,GAAA,QAASX,KAAKU,QAAQJ,KAAKN,OAEtDY,WAEG,MAAMC,EAAeb,KAAKF,gBAAgBgB,MAD9CF,GAAW,IAAHC,EAAGE,OAIH,OAAIC,OAAOC,mBAFEF,MAAbG,EAAA,MAA2B,kBAEhBD,MAAAA,EAAAA,MAAAA,8BAMf,GAAID,OAAOC,qBAAuBJ,EAAaM,MAAM,YAHjD,OAAaD,MAAEA,EAAR,MAAe,kBAM1B,MAAME,EAAiBpB,KAAKC,eAAea,MAAMC,OAH7CC,OAAAA,EAAOC,OAAPI,kBACaH,MAAEA,EAAR,MAAe,qGAAtB,CACHI,UAAApB,MAAAgB,EAAA,MAAA,YACKE,IAAAA,OAAiBC,sBAIfC,EAAmBN,OAAOO,oBAC1BrB,MAAAgB,EAAA,MAAA,oGAAA,CACKF,UAAOK,MAAAA,EAAAA,MAAAA,YAGpBG,IAAAR,OAAAO,oBAGQD,QAAAA,GACAtB,KAAAG,kBAAA,IAAAH,KAAAY,YACGV,MAAEc,UAAOO,cAUxBlB,YAAYoB,GAPR,MAAOC,EAAP1B,KAAAY,WACH,OAAA,IAAAc,GASO1B,KAAKG,iBAAkB,EARnBuB,IAEJxB,KAAMK,iBAAUoB,EACnB,CACJC,UAAA5B,KAAAF,gBAAAgB,MAUOe,SAAU7B,KAAKC,eAAea,SAPlC,IAAAlB","file":"Credentials.min.js","sourcesContent":["\"use strict\";\nclass Credentials {\n    constructor() {\n        this.$loginNameInput = $('#loginName');\n        this.$passwordInput = $('#password');\n        this.validateOnInput = false;\n        Craft.LoginForm.registerStepHandler(this.prepareData.bind(this));\n        new Craft.PasswordInput(this.$passwordInput, {\n            onToggleInput: ($newPasswordInput) => {\n                this.$passwordInput.off('input');\n                this.$passwordInput = $newPasswordInput;\n                this.$passwordInput.on('input', this.onInput.bind(this));\n            }\n        });\n        this.$loginNameInput.on('input', this.onInput.bind(this));\n        this.$passwordInput.on('input', this.onInput.bind(this));\n    }\n    validate() {\n        const loginNameVal = this.$loginNameInput.val();\n        if (loginNameVal.length === 0) {\n            // @ts-ignore\n            if (window.useEmailAsUsername) {\n                return Craft.t('app', 'Invalid email.');\n            }\n            return Craft.t('app', 'Invalid username or email.');\n        }\n        // @ts-ignore\n        if (window.useEmailAsUsername && !loginNameVal.match('.+@.+\\..+')) {\n            return Craft.t('app', 'Invalid email.');\n        }\n        const passwordLength = this.$passwordInput.val().length;\n        // @ts-ignore\n        if (passwordLength < window.minPasswordLength) {\n            return Craft.t('yii', '{attribute} should contain at least {min, number} {min, plural, one{character} other{characters}}.', {\n                attribute: Craft.t('app', 'Password'),\n                // @ts-ignore\n                min: window.minPasswordLength,\n            });\n        }\n        // @ts-ignore\n        if (passwordLength > window.maxPasswordLength) {\n            return Craft.t('yii', '{attribute} should contain at most {max, number} {max, plural, one{character} other{characters}}.', {\n                attribute: Craft.t('app', 'Password'),\n                // @ts-ignore\n                max: window.maxPasswordLength,\n            });\n        }\n        return true;\n    }\n    onInput(ev) {\n        if (this.validateOnInput && this.validate() === true) {\n            Craft.LoginForm.clearErrors();\n        }\n    }\n    prepareData(ev) {\n        const error = this.validate();\n        if (error !== true) {\n            this.validateOnInput = true;\n            return error;\n        }\n        this.validateOnInput = false;\n        return {\n            loginName: this.$loginNameInput.val(),\n            password: this.$passwordInput.val(),\n        };\n    }\n}\nnew Credentials();\n"]}