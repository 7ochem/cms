{"version":3,"sources":["editentry/src/EntryTypeSwitcher.js"],"names":["$","Craft","EntryTypeSwitcher","Garnish","Base","extend","$typeSelect","init","$spinner","insertAfter","parent","this","addListener","postActionRequest","ev","addClass","textStatus","cp","$primaryForm","serialize","response","trigger","tabsHtml","replaceWith","length","$tabs","$mainContent","insertBefore","remove","removeClass","appendHeadHtml","headHtml","appendFootHtml","bodyHtml","slugGenerator","initTabs","setNewSource","jQuery"],"mappings":"CAAA,SAACA,GAEGC,MAAAC,kBAAAC,QAAAC,KAAAC,OAAA,CACMH,YAAAA,KACFI,SAAa,KAGTC,KAAE,WACGD,KAAAA,YAAgBN,EAAA,cAChBQ,KAAAA,SAAaR,EAAA,iCAAiCS,YAAiBH,KAAAA,YAALI,UANzBC,KAAAC,YAAAD,KAAAL,YAAA,SAAA,iBActCL,aAAMY,SAAkBC,GACpBH,KAAKH,SAASO,YAAS,UAEnBC,MAAAA,kBAAJ,4BAA8Bf,MAAAgB,GAAAC,aAAAC,YAAA,CAAAC,EAAAJ,KAA9B,GACSK,KAAAA,SAAQN,SAAA,UADE,YAAfC,EAA0B,CAItBI,KAASE,QAAU,oBAETC,IAAAA,EAAYH,EAAAA,SACfA,EAAAE,UACQA,EAAXE,OACHC,EAAAF,YAAAH,EAAAE,UACQI,EAAAA,EAAaX,UAASY,aAA/B3B,EAAA,aAEAC,MAAAgB,GAAAS,aAAAX,SAAA,cAEHU,EAAAG,SADG3B,MAAMgB,GAAGS,aAAaG,YAAY,aAKhCC,EAAAA,WAAeV,KAAAA,EAASW,YACxBC,MAAAA,eAAwBC,EAAAA,YAD9BhC,MAAM6B,eAAeV,EAASW,UAI1B9B,MAAOiC,eAAkBd,EAA7Ba,UAA6B,oBAAlBC,eAIFC,cAATC,aAAA,UA7BRnC,MAAAgB,GAAAkB,WAdRxB,KAAAU,QAAA,oBAHJ,CAqDGgB","file":"EntryTypeSwitcher.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    Craft.EntryTypeSwitcher = Garnish.Base.extend({\n        $typeSelect: null,\n        $spinner: null,\n\n        init: function() {\n            this.$typeSelect = $('#entryType');\n            this.$spinner = $('<div class=\"spinner hidden\"/>').insertAfter(this.$typeSelect.parent());\n\n            this.addListener(this.$typeSelect, 'change', 'onTypeChange');\n        },\n\n        onTypeChange: function(ev) {\n            this.$spinner.removeClass('hidden');\n\n            Craft.postActionRequest('entries/switch-entry-type', Craft.cp.$primaryForm.serialize(), (response, textStatus) => {\n                this.$spinner.addClass('hidden');\n\n                if (textStatus === 'success') {\n                    this.trigger('beforeTypeChange');\n\n                    var $tabs = $('#tabs');\n                    if (response.tabsHtml) {\n                        if ($tabs.length) {\n                            $tabs.replaceWith(response.tabsHtml);\n                        } else {\n                            $(response.tabsHtml).insertBefore($('#content'))\n                        }\n                        Craft.cp.$mainContent.addClass('has-tabs');\n                    } else {\n                        $tabs.remove();\n                        Craft.cp.$mainContent.removeClass('has-tabs');\n                    }\n\n                    $('#fields').html(response.fieldsHtml);\n                    Craft.initUiElements($('#fields'));\n                    Craft.appendHeadHtml(response.headHtml);\n                    Craft.appendFootHtml(response.bodyHtml);\n\n                    // Update the slug generator with the new title input\n                    if (typeof slugGenerator !== 'undefined') {\n                        slugGenerator.setNewSource('#title');\n                    }\n\n                    Craft.cp.initTabs();\n\n                    this.trigger('typeChange');\n                }\n            });\n        }\n    });\n})(jQuery);\n"]}