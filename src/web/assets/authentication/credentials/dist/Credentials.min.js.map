{"version":3,"sources":["authentication/credentials/src/Credentials.js"],"names":["Credentials","constructor","$loginNameInput","$","this","$passwordInput","Craft","validateOnInput","registerStepHandler","prepareData","bind","parents","length","LoginForm","$newPasswordInput","onToggleInput","onInput","on","validate","loginNameVal","val","window","useEmailAsUsername","t","match","passwordLength","minPasswordLength","attribute","maxPasswordLength","max","ev","error","clearErrors","loginName","password"],"mappings":"AAAA,aACA,MAAMA,YAANC,cACIA,KAAWC,gBAAGC,EAAA,cACVC,KAAKF,eAAoBC,EAAA,aACzBC,KAAKC,iBAAmB,EACxBC,MAAKC,UAALC,oBAAAJ,KAAAK,YAAAC,KAAAN,MAAAA,KAAAF,gBAAAS,QAAA,uBAAAC,OAAA,GACAN,IAAMO,MAAAA,cAAUL,KAAAA,eAAyBC,CACrCH,cAAoBQ,IACpBC,KAAgBD,eAAAA,IAAD,SACNT,KAAAA,eAAmBS,EACnBT,KAAAA,eAAiBS,GAAAA,QAAtBV,KAAAY,QAAAN,KAAAN,UAHRA,KAAAF,gBAAAe,GAAA,QAAAb,KAAAY,QAAAN,KAAAN,OAOAA,KAAKF,eAAmBe,GAAA,QAASb,KAAKY,QAAQN,KAAKN,OAEtDc,WAEG,MAAMC,EAAef,KAAKF,gBAAgBkB,MAD9CF,GAAW,IAAHC,EAAGP,OAIH,OAAIS,OAAOC,mBAFEV,MAAbW,EAAA,MAA2B,kBAEhBD,MAAAA,EAAAA,MAAAA,8BAMf,GAAID,OAAOC,qBAAuBH,EAAaK,MAAM,YAHjD,OAAaD,MAAEA,EAAR,MAAe,kBAM1B,MAAME,EAAiBrB,KAAKC,eAAee,MAAMR,OAH7CS,OAAAA,EAAOC,OAAPI,kBACaH,MAAEA,EAAR,MAAe,qGAAtB,CACHI,UAAArB,MAAAiB,EAAA,MAAA,YACKE,IAAAA,OAAiBC,sBAIfC,EAAmBN,OAAOO,oBAC1BtB,MAAAiB,EAAA,MAAA,oGAAA,CACKF,UAAOK,MAAAA,EAAAA,MAAAA,YAGpBG,IAAAR,OAAAO,oBAGQD,QAAAA,GACAvB,KAAAG,kBAAA,IAAAH,KAAAc,YACGZ,MAAEe,UAAOO,cAUxBnB,YAAYqB,GAPR,MAAOC,EAAP3B,KAAAc,WACH,OAAA,IAAAa,GASO3B,KAAKG,iBAAkB,EARnBwB,IAEJzB,KAAMO,iBAAUmB,EACnB,CACJC,UAAA7B,KAAAF,gBAAAkB,MAUOc,SAAU9B,KAAKC,eAAee,SAPlC,IAAApB","file":"Credentials.min.js","sourcesContent":["\"use strict\";\nclass Credentials {\n    constructor() {\n        this.$loginNameInput = $('#loginName');\n        this.$passwordInput = $('#password');\n        this.validateOnInput = false;\n        Craft.LoginForm.registerStepHandler(this.prepareData.bind(this), this.$loginNameInput.parents('#recovery-container').length > 0);\n        new Craft.PasswordInput(this.$passwordInput, {\n            onToggleInput: ($newPasswordInput) => {\n                this.$passwordInput.off('input');\n                this.$passwordInput = $newPasswordInput;\n                this.$passwordInput.on('input', this.onInput.bind(this));\n            }\n        });\n        this.$loginNameInput.on('input', this.onInput.bind(this));\n        this.$passwordInput.on('input', this.onInput.bind(this));\n    }\n    validate() {\n        const loginNameVal = this.$loginNameInput.val();\n        if (loginNameVal.length === 0) {\n            // @ts-ignore\n            if (window.useEmailAsUsername) {\n                return Craft.t('app', 'Invalid email.');\n            }\n            return Craft.t('app', 'Invalid username or email.');\n        }\n        // @ts-ignore\n        if (window.useEmailAsUsername && !loginNameVal.match('.+@.+\\..+')) {\n            return Craft.t('app', 'Invalid email.');\n        }\n        const passwordLength = this.$passwordInput.val().length;\n        // @ts-ignore\n        if (passwordLength < window.minPasswordLength) {\n            return Craft.t('yii', '{attribute} should contain at least {min, number} {min, plural, one{character} other{characters}}.', {\n                attribute: Craft.t('app', 'Password'),\n                // @ts-ignore\n                min: window.minPasswordLength,\n            });\n        }\n        // @ts-ignore\n        if (passwordLength > window.maxPasswordLength) {\n            return Craft.t('yii', '{attribute} should contain at most {max, number} {max, plural, one{character} other{characters}}.', {\n                attribute: Craft.t('app', 'Password'),\n                // @ts-ignore\n                max: window.maxPasswordLength,\n            });\n        }\n        return true;\n    }\n    onInput(ev) {\n        if (this.validateOnInput && this.validate() === true) {\n            Craft.LoginForm.clearErrors();\n        }\n    }\n    prepareData(ev) {\n        const error = this.validate();\n        if (error !== true) {\n            this.validateOnInput = true;\n            return error;\n        }\n        this.validateOnInput = false;\n        return {\n            loginName: this.$loginNameInput.val(),\n            password: this.$passwordInput.val(),\n        };\n    }\n}\nnew Credentials();\n"]}