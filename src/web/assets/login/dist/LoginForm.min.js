"use strict";class LoginForm{constructor(){this.authenticationTarget="authentication/perform-authentication",this.$loginForm=$("#login-form"),this.$authContainer=$("#authentication-container"),this.$errors=$("#login-errors"),this.$messages=$("#login-messages"),this.$spinner=$("#spinner"),this.$pendingSpinner=$("#spinner-pending"),this.$submit=$("#submit"),this.$rememberMeCheckbox=$("#rememberMe"),this.$forgotPassword=$("#forgot-password"),this.$rememberPassword=$("#remember-password"),this.$loginForm.on("submit",this.invokeStepHandler.bind(this)),this.$pendingSpinner.length&&this.$loginForm.trigger("submit")}performAuthentication(e){e.scenario=Craft.cpLoginChain,this.$rememberMeCheckbox.prop("checked")&&(e.rememberMe=!0),this.clearMessages(),this.clearErrors(),Craft.postActionRequest(this.authenticationTarget,e,(e,s)=>{"success"==s&&(e.success?window.location.href=e.returnUrl:(e.error&&(this.showError(e.error),Garnish.shake(this.$loginForm)),e.message&&this.showMessage(e.message),e.html&&(this.$authContainer.html(e.html),this.stepHandler=void 0),e.footHtml&&Craft.appendFootHtml(e.footHtml),e.stepComplete&&(this.$rememberMeCheckbox.parent().remove(),this.$forgotPassword.remove(),this.$rememberPassword.remove()))),this.enableForm()})}showError(e){this.clearErrors(),$('<p style="display: none;">'+e+"</p>").appendTo(this.$errors).velocity("fadeIn")}showMessage(e){this.clearMessages(),$('<p style="display: none;">'+e+"</p>").appendTo(this.$messages).velocity("fadeIn")}registerStepHandler(e){this.stepHandler=e}invokeStepHandler(e){if("function"==typeof this.stepHandler){const s=this.stepHandler(e);"object"==typeof s?(this.disableForm(),this.performAuthentication(s)):this.showError(s)}else this.performAuthentication({});return!1}clearErrors(){this.$errors.empty()}clearMessages(){this.$messages.empty()}enableForm(){this.$submit.addClass("active"),this.$spinner.addClass("hidden")}disableForm(){this.$submit.removeClass("active"),this.$spinner.removeClass("hidden")}}Craft.LoginForm=new LoginForm;
//# sourceMappingURL=LoginForm.min.js.map
