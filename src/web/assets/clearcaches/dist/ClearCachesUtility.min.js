!function(){var $;$=jQuery,Craft.ClearCachesUtility=Garnish.Base.extend({init:function init(formId){for(var _this=this,$forms=$("form.utility"),_loop=function _loop(i){var $form=$forms.eq(i),$checkboxes=$form.find("input[type=checkbox]"),$btn=$form.find(".btn"),checkInputs=function checkInputs(){$checkboxes.filter(":checked").length?$btn.removeClass("disabled"):$btn.addClass("disabled")};$checkboxes.on("change",checkInputs),checkInputs(),_this.addListener($form,"submit",(function(ev){ev.preventDefault(),$btn.hasClass("disabled")||_this.onSubmit(ev)}))},i=0;i<$forms.length;i++)_loop(i)},onSubmit:function onSubmit(ev){var $form=$(ev.currentTarget),$trigger=$form.find("button.submit"),$status=$form.find(".utility-status"),progressBar,$allDone;$trigger.hasClass("disabled")||($form.data("progressBar")?((progressBar=$form.data("progressBar")).resetProgressBar(),$allDone=$form.data("allDone")):(progressBar=new Craft.ProgressBar($status),$form.data("progressBar",progressBar)),progressBar.$progressBar.removeClass("hidden"),progressBar.$progressBar.velocity("stop").velocity({opacity:1},{complete:function complete(){var postData=Garnish.getPostData($form),params=Craft.expandPostArray(postData);Craft.postActionRequest(params.action,params,(function(response,textStatus){response&&response.error&&alert(response.error),progressBar.setProgressPercentage(100),setTimeout((function(){$allDone||(($allDone=$('<div class="alldone" data-icon="done" />').appendTo($status)).css("opacity",0),$form.data("allDone",$allDone)),progressBar.$progressBar.velocity({opacity:0},{duration:"fast",complete:function complete(){$allDone.velocity({opacity:1},{duration:"fast"}),$trigger.removeClass("disabled"),$trigger.trigger("focus")}})}),300)}),{complete:$.noop})}}),$allDone&&$allDone.css("opacity",0),$trigger.addClass("disabled"),$trigger.trigger("blur"))}})}();
//# sourceMappingURL=ClearCachesUtility.min.js.map