{"version":3,"sources":["edituser/src/AccountSettingsForm.js"],"names":["$","Craft","AccountSettingsForm","Garnish","Base","extend","userId","$copyPasswordResetUrlBtn","$actionSpinner","$deleteBtn","init","isCurrent","settings","setSettings","defaults","addListener","this","handleCopyPasswordResetUrlBtnClick","elevatedSessionManager","proxy","requireElevatedSession","getPasswordResetUrl","textStatus","removeClass","label","value","response","url","postActionRequest","data","addClass","confirmDeleteModal","t","contentSummary","redirect","show","DeleteUserModal","deleteModalRedirect","jQuery"],"mappings":"CAAA,SAACA,GAEGC,MAAAC,oBAAAC,QAAAC,KAAAC,OAAA,CACMH,OAAAA,KACFI,UAD4C,KAI5CC,yBAJ4C,KAK5CC,eAL4C,KAQ5CC,mBAR4C,KAUxCA,WAAWH,KAEXI,KAAKC,SAAYA,EAAAA,EAAjBC,GAEKC,KAAAA,OAAYD,EAEZL,KAAAA,UAAAA,EAEAE,KAAAA,YAAeG,EAADX,MAAnBC,oBAAAY,UAGKC,KAAAA,yBAA6Bf,EAAA,2BArBMgB,KAAAR,eAAAR,EAAA,mBAwB5CiB,KAAAA,WAAAA,EAAAA,eAEUC,KAAAA,YAAAA,KAANX,yBAAsDY,QAAM,sCA1BpBH,KAAAD,YAAAC,KAAAP,WAAA,QAAA,2BAgCxCQ,mCAAW,WAAXhB,MAAAiB,uBAAAE,uBAAApB,EAAAmB,MAAAH,KAAA,yBAHJK,oBAAqB,WAUTC,KAAAA,eAAeC,YAAW,UAEtBC,IAAAA,EAAOvB,CACPwB,OAAOC,KAASC,QAGzB1B,MATH2B,kBAAA,+BAAAC,EAAA7B,EAAAmB,OAAA,SAAAO,EAAAJ,GApCwCN,KAAAR,eAAAsB,SAAA,UAiDxC,YAAUC,GACDvB,MAAAA,GAAee,qBAApB,CACMK,MAAN3B,MAAwB+B,EAAA,MAAA,2BAA4C1B,MAAAA,EAAAA,QANrEU,QAUaiB,uBAAgBP,WAChBQ,KAAQH,mBAxDhCf,KAAAe,mBAAAI,QAsDoBnB,KAAAR,eAAAe,YAAA,UAIHtB,MAAA2B,kBAAA,6BAAA,CAAAtB,OAAAU,KAAAV,QAAAN,EAAAmB,OAAA,SAAAO,EAAAJ,GAPLN,KAAAR,eAAAsB,SAAA,UASG,YAAAR,IACES,KAAAA,mBAAL,IAAA9B,MAAAmC,gBAAApB,KAAAV,OAAA,CACH2B,eAAAP,EACJQ,SAAAlB,KAAAJ,SAAAyB,yBAGGA,UAFL,CACCvB,SAAU,CACNuB,oBAAqB,QArEjC,CAwEGC","file":"AccountSettingsForm.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    Craft.AccountSettingsForm = Garnish.Base.extend({\n        userId: null,\n        isCurrent: null,\n\n        $copyPasswordResetUrlBtn: null,\n        $actionSpinner: null,\n\n        confirmDeleteModal: null,\n        $deleteBtn: null,\n\n        init: function(userId, isCurrent, settings) {\n            this.userId = userId;\n            this.isCurrent = isCurrent;\n\n            this.setSettings(settings, Craft.AccountSettingsForm.defaults);\n\n            this.$copyPasswordResetUrlBtn = $('#copy-passwordreset-url');\n            this.$actionSpinner = $('#action-spinner');\n            this.$deleteBtn = $('#delete-btn');\n\n            this.addListener(this.$copyPasswordResetUrlBtn, 'click', 'handleCopyPasswordResetUrlBtnClick');\n            this.addListener(this.$deleteBtn, 'click', 'showConfirmDeleteModal');\n        },\n\n        handleCopyPasswordResetUrlBtnClick: function() {\n            // Requires an elevated session\n            Craft.elevatedSessionManager.requireElevatedSession($.proxy(this, 'getPasswordResetUrl'));\n        },\n\n        getPasswordResetUrl: function() {\n            this.$actionSpinner.removeClass('hidden');\n\n            var data = {\n                userId: this.userId\n            };\n\n            Craft.postActionRequest('users/get-password-reset-url', data, $.proxy(function(response, textStatus) {\n                this.$actionSpinner.addClass('hidden');\n\n                if (textStatus === 'success') {\n                    Craft.ui.createCopyTextPrompt({\n                        label: Craft.t('app', 'Copy the activation URL'),\n                        value: response.url,\n                    });\n                }\n            }, this));\n        },\n\n        showConfirmDeleteModal: function() {\n            if (!this.confirmDeleteModal) {\n                this.$actionSpinner.removeClass('hidden');\n                Craft.postActionRequest('users/user-content-summary', {userId: this.userId}, $.proxy(function(response, textStatus) {\n                    this.$actionSpinner.addClass('hidden');\n                    if (textStatus === 'success') {\n                        this.confirmDeleteModal = new Craft.DeleteUserModal(this.userId, {\n                            contentSummary: response,\n                            redirect: this.settings.deleteModalRedirect\n                        });\n                    }\n                }, this));\n            } else {\n                this.confirmDeleteModal.show();\n            }\n        }\n    }, {\n        defaults: {\n            deleteModalRedirect: null\n        }\n    });\n})(jQuery);\n"]}