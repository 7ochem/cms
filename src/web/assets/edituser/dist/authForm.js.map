{"version":3,"file":"authForm.js","mappings":"YACA,IAAIA,EAAsB,CCA1BA,EAAwB,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3EH,EAAwB,SAASS,EAAKC,GAAQ,OAAOL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,ICC/FV,EAAwB,SAASC,GACX,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,M,4FCLhD,MAAMC,EACTC,cACIC,KAAKC,SAAW,+CAChBD,KAAKE,UAAW,EAChBF,KAAKG,WAAaC,EAAE,2BACpBJ,KAAKK,eAOTA,eACID,EAAE,wBAAwBE,GAAG,WAAYC,IACrC,GAAiB,SAAbA,EAAMvB,IAGN,OAFAuB,EAAMC,2BACNR,KAAKS,6BACE,KAGfL,EAAE,yBAAyBE,GAAG,SAAUC,IACpCA,EAAMC,2BACNR,KAAKS,+BAQbA,4BACI,GAAIC,MAAMC,uBAAuBC,gBAC7B,OAEJ,MAAMC,EAAUT,EAAE,+BACZU,EAAqBV,EAAE,wBACvBW,EAAqBX,EAAE,wBAE7B,GAAIS,EAAQG,OAAS,EACbH,EAAQI,MAAMD,OAAS,IACD,WAAlBH,EAAQI,MACRC,QAAQC,MAAMN,GAGdH,MAAMC,uBAAuBS,uBAAuBpB,KAAKqB,0BAA0BC,KAAKtB,YAI/F,CACD,GAAuC,GAAnCc,EAAmBG,MAAMD,QAAkD,GAAnCD,EAAmBE,MAAMD,OACjE,OAEJN,MAAMC,uBAAuBS,uBAAuBpB,KAAKqB,0BAA0BC,KAAKtB,QAOhGqB,4BACI,GAAIrB,KAAKE,SACL,OAEJF,KAAKuB,UACL,MAAMC,EAAUpB,EAAE,6BAClB,IAAIqB,EAAO,GACX,IAAK,MAAMC,KAASF,EAChBC,EAAKC,EAAMC,aAAa,SAAWD,EAAM7B,MAE7Ca,MAAMkB,kBAAkB5B,KAAKC,SAAUwB,GAAM,CAACI,EAAUC,KACpD9B,KAAK+B,SACDF,EAASG,SACTC,MAAMJ,EAASG,SAEfH,EAASK,OACTD,MAAMJ,EAASK,OAEfL,EAASM,OACTnC,KAAKG,WAAWiC,YAAYP,EAASM,MACrCnC,KAAKG,WAAaC,EAAE,2BACpBJ,KAAKK,mBASjBkB,UACIvB,KAAKE,UAAW,EAChBF,KAAKG,WAAWkC,OAAO,IAAK,IAOhCN,SACI/B,KAAKE,UAAW,EAChBF,KAAKG,WAAWkC,OAAO,IAAK,K","sources":["webpack://Craft/webpack/bootstrap","webpack://Craft/webpack/runtime/define property getters","webpack://Craft/webpack/runtime/hasOwnProperty shorthand","webpack://Craft/webpack/runtime/make namespace object","webpack://Craft/./AuthenticatorFormHandler.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export class AuthenticatorFormHandler {\n    constructor() {\n        this.endpoint = 'authentication/update-authenticator-settings';\n        this.disabled = false;\n        this.$container = $('#authenticator-settings');\n        this.attachEvents();\n    }\n    /**\n     * Attach the listeners for field events.\n     *\n     * @private\n     */\n    attachEvents() {\n        $('.authenticator-field').on('keydown', (event) => {\n            if (event.key == \"Enter\") {\n                event.stopImmediatePropagation();\n                this.handleAuthenticatorUpdate();\n                return false;\n            }\n        });\n        $('#update-authenticator').on('click', (event) => {\n            event.stopImmediatePropagation();\n            this.handleAuthenticatorUpdate();\n        });\n    }\n    /**\n     * Handle authenticator setting update.\n     *\n     * @protected\n     */\n    handleAuthenticatorUpdate() {\n        if (Craft.elevatedSessionManager.fetchingTimeout) {\n            return;\n        }\n        const $detach = $('.authenticator-field.detach');\n        const $verificationCode1 = $('#verification-code-1');\n        const $verificationCode2 = $('#verification-code-2');\n        // If detaching\n        if ($detach.length > 0) {\n            if ($detach.val().length > 0) {\n                if ($detach.val() !== 'detach') {\n                    Garnish.shake($detach);\n                }\n                else {\n                    Craft.elevatedSessionManager.requireElevatedSession(this.submitAuthenticatorUpdate.bind(this));\n                }\n            }\n        }\n        else {\n            if ($verificationCode1.val().length == 0 || $verificationCode2.val().length == 0) {\n                return;\n            }\n            Craft.elevatedSessionManager.requireElevatedSession(this.submitAuthenticatorUpdate.bind(this));\n        }\n    }\n    /**\n     * Submit authenticator setting update.\n     * @protected\n     */\n    submitAuthenticatorUpdate() {\n        if (this.disabled) {\n            return;\n        }\n        this.disable();\n        const $fields = $('input.authenticator-field');\n        let data = {};\n        for (const field of $fields) {\n            data[field.getAttribute('name')] = field.value;\n        }\n        Craft.postActionRequest(this.endpoint, data, (response, textStatus) => {\n            this.enable();\n            if (response.message) {\n                alert(response.message);\n            }\n            if (response.error) {\n                alert(response.error);\n            }\n            if (response.html) {\n                this.$container.replaceWith(response.html);\n                this.$container = $('#authenticator-settings');\n                this.attachEvents();\n            }\n        });\n    }\n    /**\n     * Disable the setting fields.\n     *\n     * @protected\n     */\n    disable() {\n        this.disabled = true;\n        this.$container.fadeTo(100, 0.5);\n    }\n    /**\n     * Enable the setting fields.\n     *\n     * @protected\n     */\n    enable() {\n        this.disabled = false;\n        this.$container.fadeTo(100, 1);\n    }\n}\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","AuthenticatorFormHandler","constructor","this","endpoint","disabled","$container","$","attachEvents","on","event","stopImmediatePropagation","handleAuthenticatorUpdate","Craft","elevatedSessionManager","fetchingTimeout","$detach","$verificationCode1","$verificationCode2","length","val","Garnish","shake","requireElevatedSession","submitAuthenticatorUpdate","bind","disable","$fields","data","field","getAttribute","postActionRequest","response","textStatus","enable","message","alert","error","html","replaceWith","fadeTo"],"sourceRoot":""}