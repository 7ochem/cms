!function(){var t={d:function(e,a){for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};!function(){"use strict";var a;t.r(e),t.d(e,{AuthenticatorFormHandler:function(){return i}}),function(t){t[t.update=0]="update",t[t.remove=1]="remove"}(a||(a={}));class i extends class{constructor(){this.attachEvents()}clearStatus(){this.setStatus("",!1)}setStatus(t,e=!0){e&&(t=`<div class="spinner"></div><span>${t}</span>`),this.$status.html(t)}setErrorStatus(t){this.$status.html(`<div class="error">${t}</div<`)}}{constructor(){super(...arguments),this.endpoint="authentication/update-authenticator-settings",this.disabled=!1}get $container(){return $("#authenticator-settings")}get $updateAuthenticator(){return $("#update-authenticator")}get $removeAuthenticator(){return $("#remove-authenticator")}get $authenticatorField(){return $("#authenticator-code")}get $status(){return $("#authenticator-status")}attachEvents(){this.$authenticatorField.on("keydown",(t=>{"Enter"==t.key&&(t.stopImmediatePropagation(),this.handleAuthenticatorUpdate(a.update))})),this.$updateAuthenticator.on("click",(t=>{t.stopImmediatePropagation(),this.handleAuthenticatorUpdate(a.update)})),this.$removeAuthenticator.on("click",(t=>{t.stopImmediatePropagation(),this.handleAuthenticatorUpdate(a.remove)}))}handleAuthenticatorUpdate(t){if(this.disabled||t==a.update&&0===this.$authenticatorField.val().length)return;let e;switch(this.disable(),t){case a.update:e={"authenticator-code":this.$authenticatorField.val()};break;case a.remove:e={detach:"detach"}}const i=t=>{this.setStatus(Craft.t("app","Updating the authenticator settings")),Craft.postActionRequest(this.endpoint,t,((t,e)=>{if(this.enable(),t.html&&(this.$container.replaceWith(t.html),this.attachEvents()),t.message&&this.setStatus(t.message,!1),t.error&&this.setErrorStatus(t.error),t.codeHtml){const e=$('<div class="modal secure fitted"></div>').append($(t.codeHtml));e.find("#close-codes").on("click",(()=>{this.codeModal.hide()})),this.codeModal=new Garnish.Modal(e,{closeOtherModals:!1,hideOnEsc:!1,hideOnShadeClick:!1,onFadeOut:()=>{e.find(".codes").remove(),this.codeModal.destroy(),this.codeModal=null}})}}))};this.setStatus(Craft.t("app","Waiting for elevated session")),Craft.elevatedSessionManager.requireElevatedSession((()=>i(e)),(()=>{this.enable(),this.clearStatus()}))}disable(){this.disabled=!0,this.$container.fadeTo(100,.5)}enable(){this.disabled=!1,this.$container.fadeTo(100,1)}}}();var a=Craft="undefined"==typeof Craft?{}:Craft;for(var i in e)a[i]=e[i];e.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})}();
//# sourceMappingURL=authForm.js.map